<?xml version="1.0" encoding="utf-8"?>
<StructureDefinition xmlns="http://hl7.org/fhir">
  <meta>
    <lastUpdated value="2018-01-19T14:56:23.62+00:00" />
  </meta>
  <url value="https://fhir.nhs.uk/STU3/StructureDefinition/ITK-MessageDefinition-1" />
  <version value="1.0.0" />
  <name value="ITK-MessageDefinition-1" />
  <status value="draft" />
  <date value="2017-11-28T13:02:45.83+00:00" />
  <publisher value="NHS Digital" />
  <contact>
    <name value="Interoperability Team" />
    <telecom>
      <system value="email" />
      <value value="interoperabilityteam@nhs.net" />
      <use value="work" />
    </telecom>
  </contact>
  <description value="This constrained MessageDefinition Resource carries the characteristics of the ITK message." />
  <purpose value="This StructureDefinition is designed to carry details of all profiles and supporting information relating to the ITK EDIS message." />
  <copyright value="Copyright © 2017 NHS Digital" />
  <fhirVersion value="3.0.1" />
  <kind value="resource" />
  <abstract value="false" />
  <type value="MessageDefinition" />
  <baseDefinition value="http://hl7.org/fhir/StructureDefinition/MessageDefinition" />
  <derivation value="constraint" />
  <differential>
    <element id="MessageDefinition.identifier">
      <path value="MessageDefinition.identifier" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.identifier.use">
      <path value="MessageDefinition.identifier.use" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.identifier.type">
      <path value="MessageDefinition.identifier.type" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.identifier.type.coding.system">
      <path value="MessageDefinition.identifier.type.coding.system" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.identifier.type.coding.code">
      <path value="MessageDefinition.identifier.type.coding.code" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.identifier.type.coding.display">
      <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-translatable">
        <valueBoolean value="true" />
      </extension>
      <path value="MessageDefinition.identifier.type.coding.display" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.identifier.system">
      <path value="MessageDefinition.identifier.system" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.identifier.value">
      <path value="MessageDefinition.identifier.value" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.identifier.period">
      <path value="MessageDefinition.identifier.period" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.identifier.assigner">
      <path value="MessageDefinition.identifier.assigner" />
      <max value="0" />
      <type>
        <code value="Reference" />
        <targetProfile value="https://fhir.hl7.org.uk/STU3/StructureDefinition/CareConnect-Organization-1" />
      </type>
    </element>
    <element id="MessageDefinition.identifier.assigner.reference">
      <path value="MessageDefinition.identifier.assigner.reference" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.version">
      <path value="MessageDefinition.version" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.name">
      <path value="MessageDefinition.name" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.title">
      <path value="MessageDefinition.title" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.status">
      <path value="MessageDefinition.status" />
      <fixedCode value="active" />
    </element>
    <element id="MessageDefinition.experimental">
      <path value="MessageDefinition.experimental" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.publisher">
      <path value="MessageDefinition.publisher" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.contact">
      <path value="MessageDefinition.contact" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.contact.telecom.system">
      <path value="MessageDefinition.contact.telecom.system" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.contact.telecom.value">
      <path value="MessageDefinition.contact.telecom.value" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.contact.telecom.rank">
      <path value="MessageDefinition.contact.telecom.rank" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.contact.telecom.period">
      <path value="MessageDefinition.contact.telecom.period" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.description">
      <path value="MessageDefinition.description" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.useContext">
      <path value="MessageDefinition.useContext" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.useContext.code">
      <path value="MessageDefinition.useContext.code" />
      <binding>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bindingName">
          <valueString value="UsageContextType" />
        </extension>
        <strength value="required" />
      </binding>
    </element>
    <element id="MessageDefinition.useContext.code.system">
      <path value="MessageDefinition.useContext.code.system" />
      <min value="1" />
      <fixedUri value="http://hl7.org/fhir/usage-context-type" />
    </element>
    <element id="MessageDefinition.useContext.code.code">
      <path value="MessageDefinition.useContext.code.code" />
      <min value="1" />
      <fixedCode value="workflow" />
    </element>
    <element id="MessageDefinition.useContext.code.display">
      <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-translatable">
        <valueBoolean value="true" />
      </extension>
      <path value="MessageDefinition.useContext.code.display" />
      <min value="1" />
      <fixedString value="Workflow Setting" />
    </element>
    <element id="MessageDefinition.useContext.code.userSelected">
      <path value="MessageDefinition.useContext.code.userSelected" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.useContext.valueCodeableConcept:valueCodeableConcept">
      <path value="MessageDefinition.useContext.valueCodeableConcept" />
      <sliceName value="valueCodeableConcept" />
      <type>
        <code value="CodeableConcept" />
      </type>
      <binding>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bindingName">
          <valueString value="UsageContextValue" />
        </extension>
        <strength value="required" />
        <valueSetReference>
          <reference value="http://hl7.org/fhir/ValueSet/v3-ActEncounterCode" />
        </valueSetReference>
      </binding>
    </element>
    <element id="MessageDefinition.useContext.valueCodeableConcept:valueCodeableConcept.coding.system">
      <path value="MessageDefinition.useContext.valueCodeableConcept.coding.system" />
      <min value="1" />
      <fixedUri value="http://hl7.org/fhir/v3/ActCode" />
    </element>
    <element id="MessageDefinition.useContext.valueCodeableConcept:valueCodeableConcept.coding.code">
      <path value="MessageDefinition.useContext.valueCodeableConcept.coding.code" />
      <min value="1" />
      <fixedCode value="IMP" />
    </element>
    <element id="MessageDefinition.useContext.valueCodeableConcept:valueCodeableConcept.coding.display">
      <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-translatable">
        <valueBoolean value="true" />
      </extension>
      <path value="MessageDefinition.useContext.valueCodeableConcept.coding.display" />
      <min value="1" />
      <fixedString value="inpatient encounter" />
    </element>
    <element id="MessageDefinition.useContext.valueCodeableConcept:valueCodeableConcept.coding.userSelected">
      <path value="MessageDefinition.useContext.valueCodeableConcept.coding.userSelected" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.jurisdiction">
      <path value="MessageDefinition.jurisdiction" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.purpose">
      <path value="MessageDefinition.purpose" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.copyright">
      <path value="MessageDefinition.copyright" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.base">
      <path value="MessageDefinition.base" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.base.reference">
      <path value="MessageDefinition.base.reference" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.parent">
      <path value="MessageDefinition.parent" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.parent.reference">
      <path value="MessageDefinition.parent.reference" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.replaces">
      <path value="MessageDefinition.replaces" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.replaces.reference">
      <path value="MessageDefinition.replaces.reference" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.event">
      <path value="MessageDefinition.event" />
      <binding>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bindingName">
          <valueString value="MessageEvent" />
        </extension>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-isCommonBinding">
          <valueBoolean value="true" />
        </extension>
        <strength value="required" />
        <description value="Code for the event this message represents" />
        <valueSetReference>
          <reference value="https://fhir.nhs.uk/STU3/ValueSet/ITK-MessageEvent-2" />
        </valueSetReference>
      </binding>
    </element>
    <element id="MessageDefinition.event.system">
      <path value="MessageDefinition.event.system" />
      <min value="1" />
      <fixedUri value="https://fhir.nhs.uk/STU3/CodeSystem/ITK-MessageEvent-2" />
    </element>
    <element id="MessageDefinition.event.version">
      <path value="MessageDefinition.event.version" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.event.code">
      <path value="MessageDefinition.event.code" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.event.display">
      <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-translatable">
        <valueBoolean value="true" />
      </extension>
      <path value="MessageDefinition.event.display" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.event.userSelected">
      <path value="MessageDefinition.event.userSelected" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.category">
      <path value="MessageDefinition.category" />
      <fixedCode value="Notification" />
    </element>
    <element id="MessageDefinition.focus">
      <path value="MessageDefinition.focus" />
      <min value="1" />
      <max value="1" />
    </element>
    <element id="MessageDefinition.focus.code">
      <path value="MessageDefinition.focus.code" />
      <fixedCode value="Bundle" />
    </element>
    <element id="MessageDefinition.focus.profile">
      <path value="MessageDefinition.focus.profile" />
      <min value="1" />
      <type>
        <code value="Reference" />
        <targetProfile value="https://fhir.nhs.uk/STU3/StructureDefinition/ITK-Message-Bundle-1" />
      </type>
    </element>
    <element id="MessageDefinition.focus.profile.extension">
      <path value="MessageDefinition.focus.profile.extension" />
      <slicing>
        <discriminator>
          <type value="value" />
          <path value="url" />
        </discriminator>
        <rules value="open" />
      </slicing>
    </element>
    <element id="MessageDefinition.focus.profile.extension:bundleAssets">
      <path value="MessageDefinition.focus.profile.extension" />
      <sliceName value="bundleAssets" />
      <max value="1" />
      <type>
        <code value="Extension" />
        <profile value="https://fhir.nhs.uk/STU3/StructureDefinition/Extension-ITK-BundledAssets-1" />
      </type>
    </element>
    <element id="MessageDefinition.focus.profile.reference">
      <path value="MessageDefinition.focus.profile.reference" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.focus.profile.identifier">
      <path value="MessageDefinition.focus.profile.identifier" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.focus.profile.display">
      <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-translatable">
        <valueBoolean value="true" />
      </extension>
      <path value="MessageDefinition.focus.profile.display" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.focus.min">
      <path value="MessageDefinition.focus.min" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.focus.max">
      <path value="MessageDefinition.focus.max" />
      <max value="0" />
    </element>
    <element id="MessageDefinition.allowedResponse.message">
      <path value="MessageDefinition.allowedResponse.message" />
      <slicing>
        <discriminator>
          <type value="exists" />
          <path value="reference" />
        </discriminator>
        <rules value="open" />
      </slicing>
      <type>
        <code value="Reference" />
        <targetProfile value="https://fhir.nhs.uk/STU3/MessageDefinition/ITK-BusAck-MessageDefinition-1" />
      </type>
    </element>
    <element id="MessageDefinition.allowedResponse.message.reference">
      <path value="MessageDefinition.allowedResponse.message.reference" />
      <min value="1" />
    </element>
    <element id="MessageDefinition.allowedResponse.message:ITK-BusAck-MessageDefinition-1">
      <path value="MessageDefinition.allowedResponse.message" />
      <sliceName value="ITK-BusAck-MessageDefinition-1" />
      <type>
        <code value="Reference" />
        <profile value="https://fhir.nhs.uk/STU3/MessageDefinition/ITK-BusAck-MessageDefinition-1" />
        <targetProfile value="https://fhir.nhs.uk/STU3/StructureDefinition/ITK-MessageDefinition-1" />
      </type>
    </element>
    <element id="MessageDefinition.allowedResponse.message:ITK-InfAck-MessageDefinition-1">
      <path value="MessageDefinition.allowedResponse.message" />
      <sliceName value="ITK-InfAck-MessageDefinition-1" />
      <type>
        <code value="Reference" />
        <profile value="https://fhir.nhs.uk/STU3/MessageDefinition/ITK-InfAck-MessageDefinition-1" />
        <targetProfile value="https://fhir.nhs.uk/STU3/MessageDefinition/ITK-InfAck-MessageDefinition-1" />
      </type>
    </element>
    <element id="MessageDefinition.allowedResponse.situation">
      <path value="MessageDefinition.allowedResponse.situation" />
      <max value="0" />
    </element>
  </differential>
</StructureDefinition>